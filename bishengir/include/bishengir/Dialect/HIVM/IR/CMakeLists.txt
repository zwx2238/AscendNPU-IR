set(tblgen_feat_list)
if(BISHENGIR_BUILD_STANDALONE_IR_ONLY)
  list(APPEND tblgen_feat_list -DBISHENGIR_BUILD_STANDALONE_IR_ONLY)
endif()

set(LLVM_TARGET_DEFINITIONS HIVMBase.td)
mlir_tablegen(HIVMDialect.h.inc -gen-dialect-decls -dialect=hivm ${tblgen_feat_list})
mlir_tablegen(HIVMDialect.cpp.inc -gen-dialect-defs -dialect=hivm ${tblgen_feat_list})
add_public_tablegen_target(BiShengIRHIVMDialectIncGen)
add_dependencies(mlir-headers BiShengIRHIVMDialectIncGen)

set(LLVM_TARGET_DEFINITIONS HIVMOps.td)
mlir_tablegen(HIVMOps.h.inc -gen-op-decls ${tblgen_feat_list})
mlir_tablegen(HIVMOps.cpp.inc -gen-op-defs ${tblgen_feat_list})
add_public_tablegen_target(BiShengIRHIVMOpIncGen)
add_dependencies(mlir-headers BiShengIRHIVMOpIncGen)

if(NOT BISHENGIR_BUILD_STANDALONE_IR_ONLY)
  set(LLVM_TARGET_DEFINITIONS HIVMInterfaces.td)
  mlir_tablegen(HIVMInterfaces.h.inc -gen-op-interface-decls)
  mlir_tablegen(HIVMInterfaces.cpp.inc -gen-op-interface-defs)
  add_public_tablegen_target(MLIRHIVMInterfacesIncGen)
  add_dependencies(mlir-headers MLIRHIVMInterfacesIncGen)

  set(LLVM_TARGET_DEFINITIONS HIVMDMAOps.td)
  mlir_tablegen(HIVMDMAOps.h.inc -gen-op-decls)
  mlir_tablegen(HIVMDMAOps.cpp.inc -gen-op-defs)
  add_public_tablegen_target(MLIRHIVMDMAOpsIncGen)
  add_dependencies(mlir-headers MLIRHIVMDMAOpsIncGen)

  set(LLVM_TARGET_DEFINITIONS HIVMVectorOps.td)
  mlir_tablegen(HIVMVectorOps.h.inc -gen-op-decls)
  mlir_tablegen(HIVMVectorOps.cpp.inc -gen-op-defs)
  add_public_tablegen_target(MLIRHIVMVectorOpsIncGen)
  add_dependencies(mlir-headers MLIRHIVMVectorOpsIncGen)
endif()

set(LLVM_TARGET_DEFINITIONS HIVMSynchronizationOps.td)
mlir_tablegen(HIVMSynchronizationOps.h.inc -gen-op-decls ${tblgen_feat_list})
mlir_tablegen(HIVMSynchronizationOps.cpp.inc -gen-op-defs ${tblgen_feat_list})
add_public_tablegen_target(BiShengIRHIVMSynchronizationOpsIncGen)
add_dependencies(mlir-headers BiShengIRHIVMSynchronizationOpsIncGen)

if(NOT BISHENGIR_BUILD_STANDALONE_IR_ONLY)
  set(LLVM_TARGET_DEFINITIONS HIVMMacroOps.td)
  mlir_tablegen(HIVMMacroOps.h.inc -gen-op-decls)
  mlir_tablegen(HIVMMacroOps.cpp.inc -gen-op-defs)
  add_public_tablegen_target(MLIRHIVMMacroOpsIncGen)
  add_dependencies(mlir-headers MLIRHIVMMacroOpsIncGen)
endif()

set(LLVM_TARGET_DEFINITIONS HIVMAttrs.td)
mlir_tablegen(HIVMEnums.h.inc -gen-enum-decls ${tblgen_feat_list})
mlir_tablegen(HIVMEnums.cpp.inc -gen-enum-defs ${tblgen_feat_list})
mlir_tablegen(HIVMAttrs.h.inc -gen-attrdef-decls -attrdefs-dialect=hivm ${tblgen_feat_list})
mlir_tablegen(HIVMAttrs.cpp.inc -gen-attrdef-defs -attrdefs-dialect=hivm ${tblgen_feat_list})
mlir_tablegen(HIVMTypes.h.inc -gen-typedef-decls -typedefs-dialect=hivm ${tblgen_feat_list})
mlir_tablegen(HIVMTypes.cpp.inc -gen-typedef-defs -typedefs-dialect=hivm ${tblgen_feat_list})
add_public_tablegen_target(BiShengIRHIVMEnumsIncGen)
add_public_tablegen_target(BiShengIRHIVMAttributesIncGen)
add_dependencies(mlir-headers BiShengIRHIVMEnumsIncGen)
add_dependencies(mlir-headers BiShengIRHIVMAttributesIncGen)

add_mlir_doc(HIVMDoc HIVMDialect Dialects/ -gen-dialect-doc -dialect=hivm)